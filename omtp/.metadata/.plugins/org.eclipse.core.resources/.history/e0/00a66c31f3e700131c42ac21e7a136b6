/*
 * MobileNode.cc
 *
 *  Created on: May 30, 2014
 *      Author: sandro
 */

#include <omnetpp.h>
#include <string.h>
#include <stdio.h>

class MobileNode : public cSimpleModule
{
private:
    simtime_t CtrlTimeout; // timeout per i messaggi di controllo
    cMessage CtrlTimeoutEvent; // pointer al self message di controllo
    simtime_t MsTimeout; // timeout per mobile solicitation
    cMessage *MsTimeoutEvent; // holds pointer to the timeout self-message
    std::string mnaddress; // mobile node actual ipv6 address
    std::string haaddress; // home address

public:
    MobileNode();
    ~MobileNode();

protected:
    virtual void initialize();
    virtual void handleMessage(cMessage *msg);
};

Define_Module(MobileNode);

MobileNode::MobileNode()
{
    CtrlTimeoutEvent = NULL;
    MsTimeoutEvent = NULL;
}

MobileNode::~MobileNode()
{
    cancelAndDelete(CtrlTimeoutEvent);
    cancelAndDelete(MsTimeoutEvent);
}

void MobileNode::initialize()
{
    // messaggio di controllo arriva ogni secondo
    CtrlTimeout = 1.0;
    CtrlTimeoutEvent = new cMessage("Self message di controllo!");

    // manda il messaggio di controllo fra CtrlTimeout
    scheduleAt(simTime()+CtrlTimeout, CtrlTimeoutEvent);
}
